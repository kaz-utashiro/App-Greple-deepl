# NAME

App::Greple::xlate - модуль поддержки перевода для greple

# SYNOPSIS

    greple -Mxlate::deepl --xlate pattern target-file

# DESCRIPTION

Модуль **-Greple** **xlate** находит текстовые блоки и заменяет их переведенным текстом. В настоящее время модулем **xlate::deepl** поддерживается только сервис DeepL.

Если вы хотите перевести обычный текстовый блок в документе стиля [pod](https://metacpan.org/pod/pod), используйте команду **greple** с модулем `xlate::deepl` и `perl` следующим образом:

    greple -Mxlate::deepl -Mperl --pod --re '^(\w.*\n)+' --all foo.pm

Шаблон `^(\w.*\n)+` означает последовательные строки, начинающиеся с буквенно-цифровой буквы. Эта команда показывает область, которая должна быть переведена. Опция **--all** используется для создания всего текста.

<div>
    <p>
    <img width="750" src="https://raw.githubusercontent.com/kaz-utashiro/App-Greple-xlate/main/images/select-area.png">
    </p>
</div>

Затем добавьте опцию `--xlate` для перевода выделенной области. Он найдет и заменит их на вывод команды **deepl**.

По умолчанию оригинальный и переведенный текст печатается в формате "маркер конфликта", совместимом с [git(1)](http://man.he.net/man1/git). Используя формат `ifdef`, вы можете легко получить нужную часть командой [unifdef(1)](http://man.he.net/man1/unifdef). Формат может быть задан опцией **--xlate-format**.

<div>
    <p>
    <img width="750" src="https://raw.githubusercontent.com/kaz-utashiro/App-Greple-xlate/main/images/format-conflict.png">
    </p>
</div>

Если вы хотите перевести весь текст, используйте опцию **--match-entire**. Это сокращение для указания соответствия шаблона всему тексту `(?s).*`.

# OPTIONS

- **--xlate**
- **--xlate-color**
- **--xlate-fold**
- **--xlate-fold-width**=_n_ (Default: 70)

    Запустите процесс перевода для каждой подобранной области.

    Без этой опции **greple** ведет себя как обычная команда поиска. Таким образом, вы можете проверить, какая часть файла будет предметом перевода, прежде чем приступить к работе.

    Результат команды попадает в стандартный аут, поэтому при необходимости перенаправьте его в файл, или используйте модуль [App::Greple::update](https://metacpan.org/pod/App%3A%3AGreple%3A%3Aupdate).

    Опция **--xlate** вызывает опцию **--xlate-color** с опцией **--color=never**.

    С опцией **--xlate-fold** преобразованный текст сворачивается на указанную ширину. Ширина по умолчанию равна 70 и может быть задана опцией **--xlate-fold-width**. Четыре колонки зарезервированы для обкатки, поэтому в каждой строке может быть не более 74 символов.

- **--xlate-engine**=_engine_

    Укажите используемый механизм перевода. Вам не обязательно использовать эту опцию, поскольку модуль `xlate::deepl` объявляет ее как `--xlate-engine=deepl`.

- **--xlate-to** (Default: `JA`)

    Укажите целевой язык. Вы можете получить доступные языки командой `deepl languages` при использовании движка **DeepL**.

- **--xlate-format**=_format_ (Default: conflict)

    Укажите формат вывода для оригинального и переведенного текста.

    - **conflict**

        Вывести оригинальный и переведенный текст в формате [git(1)](http://man.he.net/man1/git) маркеров конфликтов.

            <<<<<<< ORIGINAL
            original text
            =======
            translated Japanese text
            >>>>>>> JA

        Вы можете восстановить исходный файл следующей командой [sed(1)](http://man.he.net/man1/sed).

            sed -e '/^<<<<<<< /d' -e '/^=======$/,/^>>>>>>> /d'

    - **ifdef**

        Вывести оригинальный и переведенный текст в формате [cpp(1)](http://man.he.net/man1/cpp) `#ifdef`.

            #ifdef ORIGINAL
            original text
            #endif
            #ifdef JA
            translated Japanese text
            #endif

        Вы можете получить только японский текст с помощью команды **unifdef**:

            unifdef -UORIGINAL -DJA foo.ja.pm

    - **space**

        Выведите оригинальный и переведенный текст, разделенные одной пустой строкой.

    - **none**

        Если формат `none` или неизвестен, печатается только переведенный текст.

- **--**\[**no-**\]**xlate-progress** (Default: True)

    Просмотреть результат перевода в реальном времени в выводе STDERR.

- **--match-entire**

    Задайте весь текст файла в качестве целевой области.

# CACHE OPTIONS

Модуль **xlate** может хранить кэшированный текст перевода для каждого файла и считывать его перед выполнением, чтобы исключить накладные расходы на запрос к серверу. При стратегии кэширования по умолчанию `auto`, он сохраняет данные кэша только в том случае, если существует файл кэша для целевого файла. Если соответствующий файл кэша не существует, он его не создает.

- --xlate-cache=_strategy_
    - `auto` (Default)

        Сохранять файл кэша, если он существует.

    - `create`

        Создайте пустой файл кэша и выйдите.

    - `always`, `yes`, `1`

        Сохранять кэш в любом случае, пока целью является обычный файл.

    - `never`, `no`, `0`

        Никогда не используйте кэш-файл, даже если он существует.

    - `accumulate`

        По умолчанию неиспользуемые данные удаляются из кэш-файла. Если вы не хотите удалять их и хранить в файле, используйте `accumulate`.

# ENVIRONMENT

- DEEPL\_AUTH\_KEY

    Установите ключ аутентификации для службы DeepL.

# SEE ALSO

- [https://github.com/DeepLcom/deepl-python](https://github.com/DeepLcom/deepl-python)

    DeepL Библиотека Python и команда CLI.

- [App::Greple](https://metacpan.org/pod/App%3A%3AGreple)

    Подробную информацию о шаблоне целевого текста см. в руководстве **greple**. Используйте опции **--inside**, **--outside**, **--include**, **--exclude** для ограничения области поиска.

- [App::Greple::update](https://metacpan.org/pod/App%3A%3AGreple%3A%3Aupdate)

    Вы можете использовать модуль `-Mupdate` для модификации файлов по результату команды **greple**.

- [App::sdif](https://metacpan.org/pod/App%3A%3Asdif)

    Используйте **sdif**, чтобы показать формат маркера конфликта бок о бок с опцией **-V**.

# AUTHOR

Кадзумаса Утасиро

# LICENSE

Copyright ©︎ 2023 Kazumasa Utashiro.

Эта библиотека является свободным программным обеспечением; вы можете распространять ее и/или изменять на тех же условиях, что и сам Perl.
